flow_model:
  _target_: src.flows.flow.Flow

  # The path used during the flow; only AffinePath is supported
  path:
    _target_: src.flows.path.AffinePath 

    scheduler:
      _target_: src.flows.schedulers.OTScheduler  # or CosineScheduler

    t_law:
      _target_: torch.distributions.uniform.Uniform
      low: 0.0
      high: 1.0

  # The loss function used to train the model
  loss_fn:
    _target_: src.flows.losses.MSEFlowMatchingLoss

  # The model used to parameterize the flow
  model:
    _target_: src.experiments.models.models.TimeConditionedMLP
    x_dim: 2
    output_dim: 2
    num_fourier_bands: 4
    hidden_dim: 64
    n_layers: 4

  # The configuration for the flow
  cfg:
    _target_: src.flows.types.FlowConfig
    predicts: "x_1" # or "x_0", "score", "velocity", what the model predicts
    guidance: "classifier"  # or "classifier", "CFG"
    guidance_scale: 1.0
    compile: false # works only with nn.Module


  optimizer_cfg:
    _target_: torch.optim.Adam
    _partial_: true     # ‚Üê important!
    lr: 0.0005
    weight_decay: 0.0
    betas:
      - 0.9
      - 0.999
    eps: 1e-08
